CREATE TABLE TBL_PIZZA_01(
    pcode char(4) NOT NULL,
    pname varchar(30),
    cost number(7),
    CONSTRAINT PK_PCODE PRIMARY KEY (pcode)
);

INSERT INTO TBL_PIZZA_01 VALUES('AA01','고르골졸라피자',6000);
INSERT INTO TBL_PIZZA_01 VALUES('AA02','치즈피자',6500);
INSERT INTO TBL_PIZZA_01 VALUES('AA03','페퍼로니피자',7000);
INSERT INTO TBL_PIZZA_01 VALUES('AA04','콤비네이션피자',7500);
INSERT INTO TBL_PIZZA_01 VALUES('AA05','고구마피자',6000);
INSERT INTO TBL_PIZZA_01 VALUES('AA06','포테이토피자',7000);
INSERT INTO TBL_PIZZA_01 VALUES('AA07','불고기피자',8000);
INSERT INTO TBL_PIZZA_01 VALUES('AA08','나폴리피자',8000);

CREATE TABLE TBL_SHOP_01(
    scode char(4) NOT NULL,
    sname varchar(20),
    CONSTRAINT PK_SCODE PRIMARY KEY(scode)
);

INSERT INTO TBL_SHOP_01 VALUES ('S001','강남점');
INSERT INTO TBL_SHOP_01 VALUES ('S002','강서점');
INSERT INTO TBL_SHOP_01 VALUES ('S003','강동점');
INSERT INTO TBL_SHOP_01 VALUES ('S004','영동점');
INSERT INTO TBL_SHOP_01 VALUES ('S005','시청점');
INSERT INTO TBL_SHOP_01 VALUES ('S006','인천점');

CREATE TABLE TBL_SALELIST_01(
    saleno number(7) NOT NULL,
    scode char(4) NOT NULL,
    saledate date,
    pcode char(4) NOT NULL,
    amount number(5),
    CONSTRAINT PK_SALENO PRIMARY KEY(saleno)
);

INSERT INTO TBL_SALELIST_01 VALUES(100001,'S001','20181202','AA01',50);
INSERT INTO TBL_SALELIST_01 VALUES(100002,'S001','20181202','AA02',30);
INSERT INTO TBL_SALELIST_01 VALUES(100003,'S001','20181202','AA03',20);
INSERT INTO TBL_SALELIST_01 VALUES(100004,'S001','20181202','AA04',50);
INSERT INTO TBL_SALELIST_01 VALUES(100005,'S003','20181203','AA01',40);
INSERT INTO TBL_SALELIST_01 VALUES(100006,'S003','20181203','AA02',60);
INSERT INTO TBL_SALELIST_01 VALUES(100007,'S003','20181203','AA04',60);
INSERT INTO TBL_SALELIST_01 VALUES(100008,'S003','20181204','AA05',70);
INSERT INTO TBL_SALELIST_01 VALUES(100009,'S005','20181202','AA01',80);
INSERT INTO TBL_SALELIST_01 VALUES(100010,'S005','20181202','AA03',30);
INSERT INTO TBL_SALELIST_01 VALUES(100011,'S005','20181202','AA04',40);
INSERT INTO TBL_SALELIST_01 VALUES(100012,'S005','20181202','AA05',50);
INSERT INTO TBL_SALELIST_01 VALUES(100013,'S004','20181204','AA01',30);
INSERT INTO TBL_SALELIST_01 VALUES(100014,'S004','20181204','AA02',20);
INSERT INTO TBL_SALELIST_01 VALUES(100015,'S004','20181204','AA06',50);

DROP TABLE TBL_SALELIST_01;
DROP TABLE TBL_SHOP_01;
DROP TABLE TBL_PIZZA_01;

SELECT SHOP.SCODE, SHOP.SNAME, SUM(SALE.AMOUNT * PIZZA.COST) total 
                    FROM TBL_SHOP_01 SHOP, tbl_salelist_01 SALE, TBL_PIZZA_01 PIZZA
                    WHERE SALE.SCODE = SHOP.SCODE AND SALE.PCODE = PIZZA.PCODE
                    GROUP BY SHOP.SCODE, SHOP.SNAME
                    ORDER BY SHOP.SCODE ASC;
commit;